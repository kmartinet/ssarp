<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Species-/Speciation-Area Relationship Projector • ssarp</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Species-/Speciation-Area Relationship Projector">
<meta name="description" content="Create Species- and Speciation-Area Relationships using occurrence records or presence-absence matrices.">
<meta property="og:description" content="Create Species- and Speciation-Area Relationships using occurrence records or presence-absence matrices.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ssarp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Get_Data.html">Get Occurrence Records from GBIF</a></li>
    <li><a class="dropdown-item" href="articles/Create_SAR.html">Create Species-Area Relationship</a></li>
    <li><a class="dropdown-item" href="articles/Create_SpAR.html">Create Speciation-Area Relationship</a></li>
    <li><a class="dropdown-item" href="articles/Spatial_Autocorrelation.html">Assessing Spatial Autocorrelation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kmartinet/ssarp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="ssarp">ssarp<a class="anchor" aria-label="anchor" href="#ssarp"></a>
</h1></div>
<!-- badges: start -->

<p><code>ssarp</code> (Species-/Speciation-Area Relationship Projector) is an R package that provides a suite of functions to help users <strong>create speciation- and species- area relationships for island-dwelling taxa</strong> using occurrence data from GBIF (Global Biodiversity Information Facility) or the user’s own occurrence data.</p>
<p>The species-area relationship (SAR) is an important metric for quantifying patterns of biodiversity on islands within an island biogeographical framework. SARs visualize the relationship between species richness (the number of species) and the area of the island on which they live.</p>
<p>Additionally, the potential for speciation on islands can be visualized using a speciation-area relationship (SpAR), which plots speciation rates against the area of the island on which the associated species live. Creating both a SAR and a SpAR for taxa on a given archipelago can help researchers answer questions about the drivers of biodiversity in their systems (e.g., Is there a threshold for island size at which point <em>in situ</em> speciation drives species richness in the archipelago?).</p>
<p>SARs and SpARs are also useful for determining whether biodiversity is distributed in an unusual way in a given island system (e.g., species richness decreasing as islands get larger instead of increasing). An unusual trend in these relationships may be indicative of habitat loss or a negative impact of non-native species.</p>
<p>Please find the <a href="https://www.biorxiv.org/content/10.1101/2024.12.31.630948v1" class="external-link">bioRxiv preprint of the manuscript associated with <em>ssarp</em> here!</a></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install <em>ssarp</em>, use the “install_github” function from the <em>devtools</em> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"kmartinet/ssarp"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="suppressing-messages">Suppressing Messages<a class="anchor" aria-label="anchor" href="#suppressing-messages"></a>
</h2>
<p>To suppress all messages output by <em>ssarp</em>, run</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>ssarp.silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>before using any of <em>ssarp</em>’s functions.</p>
</div>
<div class="section level2">
<h2 id="citing-ssarp">Citing ssarp<a class="anchor" aria-label="anchor" href="#citing-ssarp"></a>
</h2>
<p>Please cite <em>ssarp</em> if you use it for your work! The citation is:</p>
<p>Martinet, K.M., Román-Palacios, C., &amp; Harmon, L.J. (2025). “SSARP: An R Package for Easily Creating Species- and Speciation- Area Relationships Using Web Databases.” <em>bioRxiv</em>. <a href="doi:10.1101/2024.12.31.630948" class="uri">doi:10.1101/2024.12.31.630948</a></p>
</div>
<div class="section level2">
<h2 id="extending-your-sar-analysees">Extending Your SAR Analysees<a class="anchor" aria-label="anchor" href="#extending-your-sar-analysees"></a>
</h2>
<p>If you want a deeper exploration of SAR models once you’ve completed your analyses with <code>ssarp</code>, the <code><a href="reference/get_richness.html">ssarp::get_richness()</a></code> function can create a species richness dataframe for use in the <a href="https://txm676.github.io/sars/articles/sars-r-package.html" class="external-link">sars R package</a>. The <code>sars</code> package allows users to fit a wide variety of SAR models that <code>ssarp</code> does not create.</p>
</div>
<div class="section level2">
<h2 id="example-creating-a-species-area-relationship">Example: Creating a Species-Area Relationship<a class="anchor" aria-label="anchor" href="#example-creating-a-species-area-relationship"></a>
</h2>
<p>A species-area relationship (SAR) visualizes the relationship between species richness (the number of species) and the area of the land mass on which the species live. This brief example covers the <em>ssarp</em> workflow for creating a SAR, and more detailed explanations of the code and methods can be found <a href="https://kmartinet.github.io/ssarp/index.html">in the Articles on the SSARP pkgdown website</a>.</p>
<p>In order to construct a species-area relationship with <em>ssarp</em>, we will:</p>
<ul>
<li>Gather occurrence data from GBIF</li>
<li>Filter out invalid occurrence records</li>
<li>Find areas of pertinent land masses</li>
<li>Create a species-area relationship</li>
</ul>
<div class="section level4">
<h4 id="step-1-gather-occurrence-data-from-gbif">Step 1: Gather occurrence data from GBIF<a class="anchor" aria-label="anchor" href="#step-1-gather-occurrence-data-from-gbif"></a>
</h4>
<p>In this step, we will find the unique identifying key associated with a taxon of interest (the lizard genus <em>Anolis</em> in this case) and use that key to access occurrence points for that taxon from GBIF. We will restrict the returned occurrence records to the Caribbean islands using the “geometry” parameter in the <code><a href="https://docs.ropensci.org/rgbif/reference/occ_search.html" class="external-link">rgbif::occ_search()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rgbif" class="external-link">rgbif</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kmartinet/ssarp" class="external-link">ssarp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define query</span></span>
<span><span class="va">query</span> <span class="op">&lt;-</span> <span class="st">"Anolis"</span></span>
<span><span class="va">rank</span> <span class="op">&lt;-</span> <span class="st">"Genus"</span></span>
<span></span>
<span><span class="va">suggestions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rgbif/reference/name_suggest.html" class="external-link">name_suggest</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">query</span>, rank <span class="op">=</span> <span class="va">rank</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The correct key is the first element in the first row</span></span>
<span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">suggestions</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print key</span></span>
<span><span class="va">key</span></span>
<span><span class="co">#&gt; [1] 8782549</span></span></code></pre></div>
<p>The GBIF key for <em>Anolis</em> is 8782549. We will use this key, along with a Well-Known Text (WKT) polygon around Caribbean islands, to get data for <em>Anolis</em> from GBIF using the <code><a href="https://docs.ropensci.org/rgbif/reference/occ_search.html" class="external-link">rgbif::occ_search()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Get data for Anolis from GBIF in a specified polygon around Caribbean islands</span></span>
<span><span class="va">occurrences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rgbif/reference/occ_search.html" class="external-link">occ_search</a></span><span class="op">(</span>taxonKey <span class="op">=</span> <span class="va">key</span>, </span>
<span>                         limit <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                         hasCoordinate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         geometry <span class="op">=</span> <span class="st">'POLYGON((-84.8 23.9, -84.7 16.4, -65.2 13.9, -63.1 11.0, -56.9 15.5, -60.5 21.9, -79.3 27.8, -79.8 24.8, -84.8 23.9))'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">occurrences</span><span class="op">$</span><span class="va">data</span></span>
<span></span>
<span><span class="co"># Print the first 5 lines of dat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 155</span></span>
<span><span class="co">#&gt;   key        scientificName   decimalLatitude decimalLongitude issues datasetKey</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;                      &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     </span></span>
<span><span class="co">#&gt; 1 5006797301 Anolis hispanio…            19.1            -70.6 cdc,c… 50c9509d-…</span></span>
<span><span class="co">#&gt; 2 5006823165 Anolis distichu…            18.7            -68.4 cdc    50c9509d-…</span></span>
<span><span class="co">#&gt; 3 5006863804 Anolis roquet (…            14.8            -60.9 cdc,c… 50c9509d-…</span></span>
<span><span class="co">#&gt; 4 5007014630 Anolis roquet (…            14.8            -60.9 cdc,c… 50c9509d-…</span></span>
<span><span class="co">#&gt; 5 5007024810 Anolis cristate…            18.5            -66.1 cdc,c… 50c9509d-…</span></span>
<span><span class="co">#&gt; # ℹ 149 more variables: publishingOrgKey &lt;chr&gt;, installationKey &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   hostingOrganizationKey &lt;chr&gt;, publishingCountry &lt;chr&gt;, protocol &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   lastCrawled &lt;chr&gt;, lastParsed &lt;chr&gt;, crawlId &lt;int&gt;, basisOfRecord &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   occurrenceStatus &lt;chr&gt;, taxonKey &lt;int&gt;, kingdomKey &lt;int&gt;, phylumKey &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   classKey &lt;int&gt;, familyKey &lt;int&gt;, genusKey &lt;int&gt;, speciesKey &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   acceptedTaxonKey &lt;int&gt;, acceptedScientificName &lt;chr&gt;, kingdom &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   phylum &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;, species &lt;chr&gt;, …</span></span></code></pre></div>
<p>The “dat” dataframe above includes the first 10,000 records from GBIF for <em>Anolis</em> within a specified polygon around the Caribbean islands.</p>
</div>
<div class="section level4">
<h4 id="step-2-filter-out-invalid-occurrence-records">Step 2: Filter out invalid occurrence records<a class="anchor" aria-label="anchor" href="#step-2-filter-out-invalid-occurrence-records"></a>
</h4>
<p>Now that we have a dataframe that includes the first 10,000 records for <em>Anolis</em> within a specified polygon around the Caribbean islands, we will filter that data to include only occurrence records that are on land. Some occurrence records might have GPS points that are in the ocean instead of on an island, so it is important to exclude these invalid records.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Find land mass names and exclude records not on land</span></span>
<span><span class="va">land_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/find_land.html">find_land</a></span><span class="op">(</span>occurrences <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print first 5 lines of land_dat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">land_dat</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                        acceptedScientificName genericName</span></span>
<span><span class="co">#&gt; 1 Anolis hispaniolae (Köhler, Zimmer, Mcgrath &amp; Hedges, 2019)      Anolis</span></span>
<span><span class="co">#&gt; 2                                 Anolis distichus Cope, 1861      Anolis</span></span>
<span><span class="co">#&gt; 3                            Anolis roquet (Bonnaterre, 1789)      Anolis</span></span>
<span><span class="co">#&gt; 4                            Anolis roquet (Bonnaterre, 1789)      Anolis</span></span>
<span><span class="co">#&gt; 5                  Anolis cristatellus Duméril &amp; Bibron, 1837      Anolis</span></span>
<span><span class="co">#&gt;   specificEpithet decimalLongitude decimalLatitude              First Second</span></span>
<span><span class="co">#&gt; 1     hispaniolae        -70.59716        19.09851 Dominican Republic   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2       distichus        -68.40635        18.67363 Dominican Republic   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3          roquet        -60.89301        14.77053         Martinique   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4          roquet        -60.89301        14.77053         Martinique   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5    cristatellus        -66.12385        18.47122               &lt;NA&gt;   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   Third                           datasetKey</span></span>
<span><span class="co">#&gt; 1  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt; 2  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt; 3  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt; 4  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt; 5  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span></code></pre></div>
<p>The “land_dat” dataframe above is a filtered version of the “dat” dataframe that we created by gathering data from GBIF. The “land_dat” dataframe includes occurrence records with GPS points that fall on a land mass, along with the locality information for that land mass.</p>
<p>The locality information is split across three columns: “first,” “second,” and “third.” The mapping utilities that <em>ssarp</em> uses sometimes output different levels of specificity for locality information (up to three different levels), so these columns provide space for these different levels. The island name that we are interested in will be in the last filled-in column of the three. For example, if there are two columns of locality information for a given occurrence record, the island name will be in the second. If there is only one column of locality information, it will contain the island name (as with Puerto Rico and Antigua above). If all columns have NA, the occurrence record is invalid and will be filtered out in the next step.</p>
</div>
<div class="section level4">
<h4 id="step-3-find-areas-of-pertinent-land-masses">Step 3: Find areas of pertinent land masses<a class="anchor" aria-label="anchor" href="#step-3-find-areas-of-pertinent-land-masses"></a>
</h4>
<p>Next, we will use the dataframe of occurrence records with their associated land mass names (the “land_dat” object created above) with the <code><a href="reference/find_areas.html">ssarp::find_areas()</a></code> function to find the area of each land mass.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Use the land mass names to get their areas</span></span>
<span><span class="va">area_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/find_areas.html">find_areas</a></span><span class="op">(</span>occs <span class="op">=</span> <span class="va">land_dat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the first 5 lines of area_dat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">area_dat</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                        acceptedScientificName genericName</span></span>
<span><span class="co">#&gt; 1 Anolis hispaniolae (Köhler, Zimmer, Mcgrath &amp; Hedges, 2019)      Anolis</span></span>
<span><span class="co">#&gt; 2                                 Anolis distichus Cope, 1861      Anolis</span></span>
<span><span class="co">#&gt; 3                            Anolis roquet (Bonnaterre, 1789)      Anolis</span></span>
<span><span class="co">#&gt; 4                            Anolis roquet (Bonnaterre, 1789)      Anolis</span></span>
<span><span class="co">#&gt; 8                            Anolis evermanni Stejneger, 1904      Anolis</span></span>
<span><span class="co">#&gt;   specificEpithet decimalLongitude decimalLatitude              First Second</span></span>
<span><span class="co">#&gt; 1     hispaniolae        -70.59716        19.09851 Dominican Republic   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2       distichus        -68.40635        18.67363 Dominican Republic   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3          roquet        -60.89301        14.77053         Martinique   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4          roquet        -60.89301        14.77053         Martinique   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 8       evermanni        -66.31459        18.29657        Puerto Rico   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   Third                           datasetKey       areas</span></span>
<span><span class="co">#&gt; 1  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7 83104562500</span></span>
<span><span class="co">#&gt; 2  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7 83104562500</span></span>
<span><span class="co">#&gt; 3  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7  1190000000</span></span>
<span><span class="co">#&gt; 4  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7  1190000000</span></span>
<span><span class="co">#&gt; 8  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7  9710687500</span></span></code></pre></div>
<p>The “area_dat” dataframe includes records with GPS points that are associated with a land mass, along with the areas of those land masses (in m^2).</p>
</div>
<div class="section level4">
<h4 id="step-4-create-the-species-area-relationship">Step 4: Create the species-area relationship<a class="anchor" aria-label="anchor" href="#step-4-create-the-species-area-relationship"></a>
</h4>
<p>Finally, we will generate the SAR using the <code><a href="reference/create_SAR.html">ssarp::create_sar()</a></code> function. The <code><a href="reference/create_SAR.html">ssarp::create_sar()</a></code> function creates multiple regression objects with breakpoints up to the user-specified “npsi” parameter. For example, if “npsi” is two, <code><a href="reference/create_SAR.html">ssarp::create_sar()</a></code> will generate regression objects with zero (linear regression), one, and two breakpoints. The function will then return the regression object with the lowest AIC score. The “npsi” parameter will be set to one in this example. Note that if linear regression (zero breakpoints) is better-supported than segmented regression with one breakpoint, the linear regression will be returned instead.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/create_SAR.html">create_sar</a></span><span class="op">(</span>occurrences <span class="op">=</span> <span class="va">area_dat</span>, npsi <span class="op">=</span> <span class="fl">1</span>, visualize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt;  ***Regression Model with Segmented Relationship(s)***</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; Call: </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; segmented.lm(obj = linear, seg.Z = ~x, npsi = 1, control = segmented::seg.control(display = FALSE))</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Estimated Break-Point(s):</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt;           Est. St.Err</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; psi1.x 21.845  0.716</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; Coefficients of the linear terms:</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.24285    1.00393  -0.242    0.810</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; x            0.05469    0.05368   1.019    0.316</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; U1.x         0.73913    0.21326   3.466       NA</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.5587 on 32 degrees of freedom</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; Multiple R-Squared: 0.6536,  Adjusted R-squared: 0.6211 </span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; Boot restarting based on 8 samples. Last fit:</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; Convergence attained in 2 iterations (rel. change 6.4306e-09)</span></span></code></pre></div>
<p>This is the species-area relationship (SAR) for Anolis including island-based occurrences within a polygon around Caribbean islands from the first 10,000 records for the genus in GBIF! The best-fit model was a segmented regression with one breakpoint. The R console will also output statistical information about the model.</p>
</div>
<div class="section level3">
<h3 id="a-note-about-spatial-autocorrelation">A Note About Spatial Autocorrelation<a class="anchor" aria-label="anchor" href="#a-note-about-spatial-autocorrelation"></a>
</h3>
<p>Species-area relationships (SARs) and speciation-area relationships (SpARs) are impacted by the environmental and spatial characteristics of the islands (or island-like areas) of interest. When inferring SARs and SpARs, researchers typically treat these effects as part of the broader biogeographic processes that are captured by the SARs and SpARs (Triantis et al. 2012). However, ignoring spatial effects when inferring SARs and SpARs can result in biased parameter estimates (Barros et al. 2023). Please refer to <a href="https://kmartinet.github.io/ssarp/articles/Spatial_Autocorrelation.html">this vignette to learn more about how to test for spatial autocorrelation when using <code>ssarp</code> to create SARs and SpARs</a>.</p>
</div>
<div class="section level3">
<h3 id="workflow-summary-for-using-data-from-gbif-to-create-a-species-area-relationship-plot">Workflow Summary for using data from GBIF to create a species-area relationship plot<a class="anchor" aria-label="anchor" href="#workflow-summary-for-using-data-from-gbif-to-create-a-species-area-relationship-plot"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Use <code>rgbif</code> to gather occurrence records, or input your own dataframe of occurrence records.</li>
<li>Use <code><a href="reference/find_land.html">find_land()</a></code> with the dataframe obtained in Step 1 to figure out the names of landmasses using the occurrence record GPS points and the <a href="https://cran.r-project.org/web/packages/maps/index.html" class="external-link"><em>maps</em> R package</a>. Setting the <code>fillgaps</code> parameter to <code>TRUE</code> will enable the use of <a href="https://photon.komoot.io/" class="external-link">Photon API</a> to fill in any missing landmass names left by the <em>maps</em> R package.</li>
<li>Use <code><a href="reference/find_areas.html">find_areas()</a></code> with the dataframe obtained in Step 2 to match the landmass names to a dataset that includes names of most islands on the planet and their areas. If the user would like to use a custom island area dataset instead of the built-in one, the <code>area_custom</code> parameter can be set to the name of the custom island area dataframe. If you’d like to only include occurrence records from islands, you can remove continental records by using <code><a href="reference/remove_continents.html">remove_continents()</a></code> with the dataframe returned by <code><a href="reference/find_areas.html">find_areas()</a></code>
</li>
<li>Use <code><a href="reference/create_SAR.html">create_sar()</a></code> with the dataframe obtained in Step 3 to create a species-area relationship plot that reports information important to the associated regression. The <code>npsi</code> parameter indicates the maximum number of breakpoints the user would like to compare for model selection. The returned model and plot correspond with the best-fit model.</li>
</ol>
</div>
<div class="section level3">
<h3 id="workflow-summary-for-using-data-from-gbif-and-a-user-provided-phylogenetic-tree-to-create-a-speciation-area-relationship-plot">Workflow summary for using data from GBIF and a user-provided phylogenetic tree to create a speciation-area relationship plot<a class="anchor" aria-label="anchor" href="#workflow-summary-for-using-data-from-gbif-and-a-user-provided-phylogenetic-tree-to-create-a-speciation-area-relationship-plot"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Use <code>rgbif</code> to gather occurrence records, or input your own dataframe of occurrence records.</li>
<li>Use <code><a href="reference/find_land.html">find_land()</a></code> with the dataframe obtained in Step 1 to figure out the names of landmasses using the occurrence record GPS points and the <a href="https://cran.r-project.org/web/packages/maps/index.html" class="external-link"><em>maps</em> R package</a>. Setting the <code>fillgaps</code> parameter to <code>TRUE</code> will enable the use of <a href="https://photon.komoot.io/" class="external-link">Photon API</a> to fill in any missing landmass names left by the <em>maps</em> R package.</li>
<li>Use <code><a href="reference/find_areas.html">find_areas()</a></code> with the dataframe obtained in Step 2 to match the landmass names to a dataset that includes names of most islands on the planet and their areas. If the user would like to use a custom island area dataset instead of the built-in one, the <code>area_custom</code> parameter can be set to the name of the custom island area dataframe. If you’d like to only include occurrence records from islands, you can remove continental records by using <code><a href="reference/remove_continents.html">remove_continents()</a></code> with the dataframe returned by <code><a href="reference/find_areas.html">find_areas()</a></code>
</li>
<li>Use either <code><a href="reference/estimate_DR.html">estimate_dr()</a></code> or <code><a href="reference/estimate_MS.html">estimate_ms()</a></code> with your own phylogenetic tree that corresponds with the taxa signified in previous steps, a classifier that describes your tip labels (whether the tip labels are simply species epithets or full scientific names), and the dataframe obtained in Step 3 to add tip speciation rates using the DR statistic (Jetz et al. 2012) or the lambda calculation for crown groups from Magallόn and Sanderson (2001) respectively to the occurrence dataframe. The user may also choose to estimate tip speciation rates from a BAMM analysis (Rabosky 2014) by using <code><a href="reference/estimate_BAMM.html">estimate_bamm()</a></code> with a classifier that describes your tip labels (whether the tip labels are simply species epithets or full scientific names), the occurrence record dataframe obtained in Step 3, and a <code>bammdata</code> object generated by reading the event data file from a BAMM analysis with the <em>BAMMtools</em> package (Rabosky et al. 2014).</li>
<li>Use <code>create_spar(occ, npsi)</code> with the dataframe obtained in Step 4 to create a speciation-area relationship plot that reports information important to the associated regression. The <code>npsi</code> parameter indicates the maximum number of breakpoints the user would like to compare for model selection. The returned model and plot correspond with the best-fit model.</li>
</ol>
</div>
<div class="section level3">
<h3 id="some-helpful-notes-about-well-known-text-wkt-representation-of-geometry">Some helpful notes about well-known text (WKT) representation of geometry<a class="anchor" aria-label="anchor" href="#some-helpful-notes-about-well-known-text-wkt-representation-of-geometry"></a>
</h3>
<p>When using <code><a href="https://docs.ropensci.org/rgbif/reference/occ_search.html" class="external-link">rgbif::occ_search</a></code> to gather occurrence records from GBIF, the user can specify a well-known text (WKT) representation of geometry to restrict the geographic location of the returned occurrence records. The <code><a href="https://docs.ropensci.org/rgbif/reference/occ_search.html" class="external-link">rgbif::occ_search</a></code> function requires a counter-clockwise winding order for WKT. I find it helpful to think about WKT polygons in this way: imagine a square around your geographic area of interest and pick one of the corners as a starting point. The order of points in WKT format should follow counter-clockwise from the corner you picked first, and the final entry in the WKT string needs to be the same as the first entry. Additionally, while GPS points are typically represented in “latitude, longitude” format, WKT expects them in “longitude latitude” format with commas separating the points rather than individual longitude and latitude values. WKT polygons can have more specified points than included in this simple square example, and even include polygons nested within others or polygons with holes in the middle.</p>
<div class="section level4">
<h4 id="literature-cited">Literature Cited<a class="anchor" aria-label="anchor" href="#literature-cited"></a>
</h4>
<ul>
<li>Barros, D.D., Mathias, M.d.L., Borges, P.A.V., &amp; Borda-de-Água, L. (2023). The Importance of Including Spatial Autocorrelation When Modelling Species Richness in Archipelagos: A Bayesian Approach. Diversity, 15: 127.</li>
<li>Jetz, W., Thomas, G.H, Joy, J.B., Harmann, K., &amp; Mooers, A.O. (2012). The global diversity of birds in space and time. <em>Nature</em>, 491: 444-448.</li>
<li>Magallόn, S. &amp; Sanderson, M.J. (2001). Absolute Diversification Rates in Angiosperm Clades. <em>Evolution</em>, 55(9): 1762-1780.</li>
<li>Rabosky, D.L. (2014). Automatic Detection of Key Innovations, Rate Shifts, and Diversity-Dependence on Phylogenetic Trees. PLOS ONE, 9(2): e89543.436</li>
<li>Rabosky, D.L., Grundler, M., Anderson, C., Title, P., Shi, J.J., Brown, J.W., Huang, H., &amp; Larson, J.G. (2014). BAMMtools: an R package for the analysis of evolutionary dynamics on phylogenetic trees. Methods in Ecology and Evolution, 5: 701-707.</li>
<li>Triantis, K.A., Guilhaumon, F., &amp; Whittaker, R.J. (2012), The island species–area relationship: biology and statistics. Journal of Biogeography, 39: 215-231.</li>
</ul>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/kmartinet/ssarp/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/kmartinet/ssarp/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;=2)</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ssarp</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Kristen Martinet <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3905-9507" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://codecov.io/gh/kmartinet/ssarp?branch=main" class="external-link"><img src="https://codecov.io/gh/kmartinet/ssarp/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/kmartinet/ssarp/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/kmartinet/ssarp/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://github.com/ropensci/software-review/issues/685" class="external-link"><img src="https://badges.ropensci.org/685_status.svg" alt="Status at rOpenSci Software Peer Review"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristen Martinet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
